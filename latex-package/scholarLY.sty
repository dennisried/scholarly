\ProvidesPackage{scholarLY}

\RequirePackage{verbatim}
\RequirePackage{ifthen}
\RequirePackage{enumitem}
  \setlist[enumerate]{leftmargin=*}
  \setlength{\parskip}{0em}
  \setlist{parsep=0pt}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% OPTIONS ... the customizable part of the package
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~
%% ~ ~ ~ DRAFT or FINAL MODE  ~
% ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~

\newif\ifex@draft % (implicitly final) ... i.e. draft mode if set, otherwise final mode,
                  % which can also be explicitly set: \usepackage[final]{scholarLY}

\DeclareOption{draft}{\ex@drafttrue}
\DeclareOption{final}{\ex@draftfalse}
\ProcessOptions*

\ifex@draft
  \newcommand\skipornot{\par}
\else
  \newcommand\skipornot{, } % TODO: leave empty here, add conditional comma for
\fi                         % each parameter (exist if used; none/empty if not)

% ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~
%% ~ ~ ~ ENUMERATION STYLE: (1) OR 1) ~
% ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~

\renewcommand\labelenumi{\theenumi)}     % This should be easily customizable by
% \renewcommand\labelenumi{(\theenumi)}  % the user. Either recommend in the documentation
                                         % that it can be changed as such, or create an
                                         % abbreviated command for the user.

% ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~
%% ~ ~ ~ FORMAT FOOTNOTES ~
% ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~

\newcommand{\fnOneText}[1]{#1}
\newcommand{\fnTwoText}[1]{#1}
\newcommand{\fnThreeText}[1]{#1}
\newcommand{\fnFourText}[1]{#1}
\newcommand{\fnFiveText}[1]{#1}

\newcommand{\fnOne}[1]{\footnotemark\footnotetext{\fnOneText}}
\newcommand{\fnTwo}[1]{\footnotemark\footnotetext{\fnTwoText}}
\newcommand{\fnThree}[1]{\footnotemark\footnotetext{\fnThreeText}}
\newcommand{\fnFour}[1]{\footnotemark\footnotetext{\fnFourText}}
\newcommand{\fnFive}[1]{\footnotemark\footnotetext{\fnFiveText}}

%example: ... NOTE: remove this later, after testing
%
% \musicalIssue \with {
%   message = "This is my message\fnOne, and it has two footnotes."
%   fnOneText = "This is the text of the footnote"
%   annotation-footnote = "This automatically tagged to end of message"
% }

% ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~
%% ~ ~ ~ CONTINUE or RESET FOOTNOTE COUNT ~
% ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~

% TODO ..

% LaTeX will automatically restart the footnote counter following the last
% lilypond-encoded footnote if: \paper { reset-footnotes-on-new-page = ##t } (default)
% ... by prepending: \lastfootnote{} :to the latex export (.inp) list.
%
% If: { reset-footnotes... = ##f } :is set by the user, LilyPond prepends, for
% example:: \lastfootnote{#}  :... "#" being the last LilyPond footnote number

% \newif\ifex@resetfootnote
\newcommand{\lastfootnote}[1]{\setcounter{footnote}{#1}}

% To manually reset (overriding continuation, if applicable) the user writes the
% following before the \annotations{filename} command in their LaTeX document:
% \setcounter{footnote}
% { the code to reset }

% ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~
%% ~ ~ ~ STYLING OPTIONS  ~
% ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~

% TODO ..


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% ENVIRONMENTS and COMMANDS ... the main part of the package
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% ~ ~ ~ ENVIRONMENTS ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~

% TODO .. automatically wrap the list in this environment:
\newenvironment{scholarLYannotations}
  {\begin{enumerate}\setlength\parindent{0pt}}{\end{enumerate}}

%% ~ ~ ~ THE COMMANDS ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~

% The LAST parameter in each set is footnote. If empty, one won't be created. If
% other optional parameters are added in the future, these places (#1, #2, etc)
% may shift. Non-defined parameters should always make the list as {}, otherwise
% latex will assume the next argument (whether {} or {argument}) in that place.

\newcommand{\criticalRemark}[5]{
  \item{\textit{(Critical Remark)}\skipornot
  \textbf{M.#1,}} {beat #2}\skipornot
  {#3}\skipornot
  {``#4''}\ifthenelse{\equal{#5}{}}{}{\footnotemark\footnotetext{#5}}
}

\newcommand{\musicalIssue}[6]{
  \item{\textit{(Musical Issue)}\skipornot
  \textbf{M.#1,}} {beat #2}\skipornot
  {#3}\skipornot
  {#4}\skipornot
  {``#5''}\ifthenelse{\equal{#6}{}}{}{\footnotemark\footnotetext{#6}}
}

\newcommand{\lilypondIssue}[5]{
  \item{\textit{(LilyPond Issue)}\skipornot
  \textbf{M.#1,}} {beat #2}\skipornot
  {#3}\skipornot
  {``#4''}\ifthenelse{\equal{#5}{}}{}{\footnotemark\footnotetext{#5}}
}

\newcommand{\question}[5]{
  \item{\textit{(Question)}\skipornot
  \textbf{M.#1,}} {beat #2}\skipornot
  {#3}\skipornot
  {``#4''}\ifthenelse{\equal{#5}{}}{}{\footnotemark\footnotetext{#5}}
}

\newcommand{\todo}[5]{
  \item{\textit{(TODO)}\skipornot
  \textbf{M.#1,}} {beat #2}\skipornot
  {#3}\skipornot
  {``#4''}\ifthenelse{\equal{#5}{}}{}{\footnotemark\footnotetext{#5}}
}

\newcommand{\annotations}[1]{\input{#1}} % the main command

\endinput
